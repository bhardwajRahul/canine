<%= form_with model: notifier, url: notifier.persisted? ? project_notifier_path(@project, notifier) : project_notifiers_path(@project), data: { turbo_frame: "new_notifier" } do |f| %>
  <% if notifier.errors.any? %>
    <div class="alert alert-error mb-4">
      <ul>
        <% notifier.errors.full_messages.each do |message| %>
          <li><%= message %></li>
        <% end %>
      </ul>
    </div>
  <% end %>

  <div class="form-control w-full max-w-xs">
    <label class="label">
      <span class="label-text">Name <span class="text-error">*</span></span>
    </label>
    <%= f.text_field :name, class: "input input-bordered w-full", placeholder: "e.g. Deploy Alerts", required: true %>
  </div>

  <div class="form-control w-full mt-4">
    <label class="label">
      <span class="label-text">Provider</span>
    </label>
    <%= render "shared/partials/radio_selector",
      selected: notifier.provider_type || "slack",
      options: [
        {
          name: "notifier[provider_type]",
          value: "slack",
          href: nil,
          icon: "logos:slack-icon",
          label: "Slack",
          description: "Send notifications to a Slack channel",
          partial: "projects/notifiers/slack_instructions",
          locals: {}
        },
        {
          name: "notifier[provider_type]",
          value: "discord",
          href: nil,
          icon: "logos:discord-icon",
          label: "Discord",
          description: "Send notifications to a Discord channel",
          partial: "projects/notifiers/discord_instructions",
          locals: {}
        },
        {
          name: "notifier[provider_type]",
          value: "microsoft_teams",
          href: nil,
          icon: "logos:microsoft-teams",
          label: "Microsoft Teams",
          description: "Send notifications to a Teams channel",
          partial: "projects/notifiers/microsoft_teams_instructions",
          locals: {}
        },
        {
          name: "notifier[provider_type]",
          value: "google_chat",
          href: nil,
          icon: "/images/logos/google-chat.webp",
          label: "Google Chat",
          description: "Send notifications to a Google Chat space",
          partial: "projects/notifiers/google_chat_instructions",
          locals: {}
        }
      ] %>
  </div>

  <div class="form-control w-full mt-4">
    <label class="label">
      <span class="label-text">Webhook URL</span>
    </label>
    <%= f.text_field :webhook_url, class: "input input-bordered w-full font-mono text-sm", placeholder: "https://hooks.slack.com/services/..." %>
  </div>

  <div class="form-control rounded-lg bg-base-200 p-2 px-4 max-w-sm mt-4">
    <label class="label mt-1">
      <span class="label-text cursor-pointer">Enabled</span>
      <%= f.check_box :enabled, class: "checkbox" %>
    </label>
  </div>

  <div class="form-footer">
    <%= f.submit notifier.persisted? ? "Update Notifier" : "Create Notifier", class: "btn btn-primary", data: { turbo: false } %>
    <%= link_to "Cancel", edit_project_path(@project), class: "btn btn-ghost", data: { turbo: false } %>
  </div>
<% end %>
